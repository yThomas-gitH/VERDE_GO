<div data-controller="route-loader mapbox-routes" 
     data-route-loader-journey-id-value="<%= @journey.id %>"
     data-route-loader-poll-interval-value="2000">
  
  <!-- Loading Screen -->
  <div data-route-loader-target="loading" class="loading-container">
    <div class="loading-content">
      <div class="spinner"></div>
      <h2>Calcul de vos routes en cours...</h2>
      <p>Nous analysons les meilleures options de transport pour votre trajet</p>
      <div class="progress-bar">
        <div class="progress-fill" data-route-loader-target="progressBar"></div>
      </div>
      <p class="progress-text" data-route-loader-target="progressText">0%</p>
    </div>
  </div>

  <!-- Routes Content (hidden initially) -->
  <div data-route-loader-target="content" class="routes-container" style="display: none;">
    <!-- Liste des routes à gauche -->
    <div class="routes-sidebar">
      <h1>Routes</h1>
      <div data-route-loader-target="routesList">
        <% if @routes.present? %>
          <% @routes.each_with_index do |route, index| %>
            <%= render partial: 'route_item', locals: { route: route, index: index } %>
          <% end %>
        <% end %>
      </div>
    </div>

    <!-- Carte Mapbox à droite -->
    <div class="map-container">
      <div data-mapbox-routes-target="map" 
           data-mapbox-token="<%= ENV['MAPBOX_ACCESS_TOKEN'] %>"
           class="map">
      </div>
    </div>
  </div>
</div>